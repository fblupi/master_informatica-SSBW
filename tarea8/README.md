# Tarea 8

## API restaurante

En esta tarea añadiremos una API REST a nuestra aplicación, siguiendo el tutorial de la página [Django + MongoDB = Django REST Framework Mongoengine](https://medium.com/@vasjaforutube/django-mongodb-django-rest-framework-mongoengine-ee4eb5857b9a), y la documentación de [Django Rest Framework Mongoengine](https://github.com/umutbozkurt/django-rest-framework-mongoengine).

```
pip install djangorestframework
pip install django-rest-framework-mongoengine
```

y las añadimos a **settings.py**:

```python
INSTALLED_APPS = (
  ...,
  'registration',
  'rest_framework',
  'rest_framework_mongoengine',
  'restaurantes',
)
```

y hacemos un nuevo archivo **serializers.py** para el API, más o menos:

```python
from rest_framework_mongoengine import serializers
from rest_framework_mongoengine import viewsets

from .models import restaurants

class restaurantsSerializer(serializers.DocumentSerializer):

    class Meta:
        model = restaurants
        fields = ('name', 'cuisine', 'borough', 'address', 'image')


class restaurantsViewSet(viewsets.ModelViewSet):
    lookup_field = 'name'
    serializer_class = restaurantsSerializer

    def get_queryset(self):
        return restaurants.objects.all()
```

y nos faltaría añadir las rutas para el API en **urls.py**:

```python
from rest_framework_mongoengine import routers

from . import views
from . import serializers

# this is DRF router for REST API viewsets
router = routers.DefaultRouter()

# register REST API endpoints with DRF router
router.register(r'restaurants', serializers.restaurantsViewSet, r"restaurants")


urlpatterns = [
         ...
           # REST API root view (generated by DRF router)
           url(r'^api/', include(router.urls, namespace='api')),

]
```

## Instrucciones de uso

```
virtualenv -p python3 venv
source venv/bin/activate
pip install Django
pip install mongoengine
pip install Pillow
pip install lxml
pip install django-regristration-redux
pip install djangorestframework
pip install django-rest-framework-mongoengine
cd sitio_web
python manage.py migrate
python manage.py runserver
```
